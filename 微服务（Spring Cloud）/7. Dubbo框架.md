
## 什么是RPC

*RPC (Remote Procedure Call)*：**远程过程调用**。

目标是为了实现 **两台（多台）计算机 / 服务器**，*相互调用方法 / 通信* 的。

RPC只是*实现远程调用*的**一套标准/规则**，该标准主要规定了*两部分内容：*
1. 通信协议
2. 序列化协议


为了方便大家 **理解** RPC，下面的图片帮助理解
![[RPC概述1.png]]
上面图是老婆和老公在家的时，老婆让老公洗碗的调用流程
这个流程可以理解为项目内的功能的调用，类似面向对象编程实例化对象，调用方法的过程。

但是*如果*这个调用关系*是远程的*，意思是老婆和老公现在是*两个不同的项目*：
![[RPC概述2.png]]
我们看到上图中，*远程调用 必须借助* 一个 **通信设备**，图片中是*手机*

- **通信协议**：
    - 通信协议指的就是 *远程调用* 的 **通信方式**。
    - 实际上这个通知的方式可以有多种，例如：写信,飞鸽传书,发电报  
    - 在程序中，通信方法实际上也是 *有多种* 的，每种通信方式会 *有不同的优缺点*。

- **序列化协议**：
    - 序列化协议指 **通信内容的格式**，*双方都要 理解这个格式*。
        - 上面的图片中，老婆给老公发信息，一定是双方都能理解的信息。
    - **发送信息** 是 *序列化过程*，**接收信息** 需要 *反序列化*。
    - 程序中，序列化的方式也是*多种*的，每种序列化方式也会*有不同的优缺点*。



## 什么是Dubbo

上面对RPC有基本认识之后，再学习Dubbo就简单了

Dubbo 是一套 **RPC框架**。
既然是框架，我们可以在框架结构基础上，*定义*Dubbo中使用的*通信协议*，*使用序列化框架技术*，而 *数据格式由Dubbo定义*，我们负责配置之后 *直接* **通过客户端调用服务端代码**。

可以说 Dubbo 就是 *RPC概念的实现*。

Dubbo是 *SpringCloudAlibaba* 提供的框架。

能够 **实现** *微服务相互调用*的功能!


## Dubbo对协议的支持

RPC框架分 **通信协议** 和 **序列化协议**  

Dubbo框架 *支持多种* 通信协议和序列化协议，可以 **通过配置文件进行修改**
  
Dubbo支持的**通信协议**：
* *dubbo协议*（**默认**）
* rmi协议  
* hessian协议  
* http协议  
* webservice  
* .....  
  
支持的**序列化协议**：
* *hessian2*（**默认**）
* java序列化  
* compactedjava  
* nativejava  
* fastjson  
* dubbo  
* fst  
* kryo  
  
Dubbo*默认情况下（默认的通信协议和序列化协议）*，支持的协议有如下**特征**：
* 采用 **N IO** *单一长链接*。
* 优秀的 **并发性能**，但是*处理大型文件 的能力 差*  。
  
Dubbo方便支持 **高并发 和 高性能**


## Dubbo的发展历程

![[Dubbo的发展历程.png]]

> Dubbo历程

在dubbo2012年底停止更新后  

国内很多公司在Dubbo的基础上进行修改，继续更新
比较知名的修改版本就是当当网的DubboX  

2012年底dubbo停止更新后到2017年dubbo继续更新之前，
2015SpringCloud开始兴起，当时没有阿里的框架，
国内公司要从SpringCloud和Dubbo中 *抉择* 使用哪个微服务方案。
  
**我们学习的Dubbo指的都是2.7之后的版本**，是**能够**和SpringCloudAlibaba*配合使用*的

## Dubbo 服务的 注册与发现

在Dubbo的调用过程中，*必须包含注册中心* 的支持。
项目 *调用服务的模块* **必须在同一个注册中心** 中。

注册中心推荐阿里自己的Nacos，兼容性好，能够发挥最大性能。
但是Dubbo也支持其他软件作为注册中心（例如Redis，zokeeper等）


**服务发现**：即 *消费端(老婆)* **自动发现 服务地址列表** 的能力，是微服务框架需要具备的 **关键能力**，借助于自动化的服务发现，微服务之间可以在 *无需感知对端 部署位置 与 IP地址* 的情况下实现通信。

之前RPC示例中，老婆就是服务的消费端，她能发现老公具备的服务。
如果老婆调用了老公的服务,就是完成了Dubbo调用。

![[Dubbo注册发现流程.png]]

consumer服务的 *消费者*，指 **服务的调用者**(*使用者*)也就是 *老婆* 的位置。
provider服务的 *提供者*，指 **服务的拥有者**(*生产者*)也就是 *老公* 的位置。

在Dubbo中，远程调用 *依据* 是服务的 **提供者在Nacos中 注册的服务名称**。
*一个服务名称，可能有多个运行的实例，任何一个空闲的实例都可以提供服务*。

> 常见面试题:Dubbo的注册发现流程
> 
> 1. 首先服务的 **提供者** 启动服务时，将自己的具备的服务注册到注册中心，其中 *包括* 当前 **提供者的ip地址和端口号** 等信息，Dubbo会 *同时注册* 该项目提供的远程调用的方法。
> 2. **消费者**(使用者)启动项目，也注册到注册中心,同时 *从注册中心中获得* 当前项目具备的 *所有服务列表*。
> 3. 当注册中心中 **有新的服务出现时**，(**在心跳时**)会*通知*已经订阅发现的*消费者*，消费者会*更新所有服务列表*。
> 4. **RPC调用**，*消费者* 需要调用远程方法时，*根据* 注册中心 *服务列表的信息*，**只需服务名称**，不需要ip地址和端口号等信息，就可以利用Dubbo调用远程方法了。


## Dubbo 实现微服务调用

[[11. duboo实现微服务调用]]


## Dubbo 的负载均衡

[[12. Dubbo的负载均衡]]