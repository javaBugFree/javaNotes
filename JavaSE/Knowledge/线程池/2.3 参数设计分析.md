
要设计一个好的线程池，就必须合理的设置线程池的4个参数；那到底该如何合理的设计4个参数的值呢？


## 参数的设计

1. **核心线程数（corePoolSize）**
    - 核心线程数的设计需要依据 *每个任务的处理时间* 和 *每秒产生的任务数量* 来确定。
    - *例如*：执行一个任务需要0.1秒，系统80%的时间每秒都会产生100个任务，那么想要在1秒内处理完这100个任务，就需要10个线程，此时我们就可以设计核心线程数为10；
    - 当然实际情况不可能这么平均，所以我们一般按照 *8020原则* 设计即可，既按照80%的情况设计核心线程数，剩下的20%可以利用最大线程数处理。

2. **任务队列长度（workQueue）**
    - 任务队列长度一般设计为：*公式：* `核心线程数 / 单个任务执行时间 * 2`（最大每个任务等待时间为2秒，如果想要为3秒就 乘以3 ）即可。
    - 例如上面的场景中，核心线程数设计为10，但各个任务执行时间为0.1秒，则队列长度可以设计为200。

3. **最大线程数量（maximumPoolSize）**
    - 最大线程数的式设计处理需要参照*核心线程数*的条件外，还需要参照系统*每秒产生的最大任务数*决定。
    - *公式：* `最大线程数 = (最大任务数 - 任务队列长度) * 单个任务执行时间`
    - 例如：上述环境中，如果系统每秒最大产生的任务是1000个，那么最大线程数 = (1000-200) * 0.1 = 80个；

4. **最大空闲时间（keepAliveTime）**
    - 这个参数的设计完全参考系统运行环境和硬件压力设定， *没有固定的参考值*，用户可以根据经验和系统产生任务的时间间隔合理设置一个值即可；

小提示：
上述4个参数的设置只是一般的设计原则，并不是固定的，用户也可以根据实际情况灵活调整。