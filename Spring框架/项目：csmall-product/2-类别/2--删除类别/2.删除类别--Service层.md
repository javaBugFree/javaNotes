
在`ICategoryService`接口中添加抽象方法：  
```java  
/**  
 * 根据id删除类别  
 * 
 * @param id 类别id  
 */
 void delete(Long id);  
```  
  
在`CategoryServiceImpl`中实现以上方法：  
  
```java  
public void delete(Long id) {  
    // 调用Mapper对象的getStandardById()执行查询  
    // 判断查询结果是否为null  
    // 是：数据已经不存在，抛出异常（NOT_FOUND）  
    
    // 判断以上查询结果中的isParent是否为1  
    // 是：当前尝试删除的是父级类别，抛出异常（CONFLICT）  
    
    // 调用BrandCategoryMapper对象的countByCategory()执行统计  
    // 判断统计结果是否大于0  
    // 是：当前尝试删除的类别关联到了某些品牌，抛出异常（CONFLICT）  
    // 调用CategoryAttributeTemplateMapper对象的countByCategory()执行统计  
    // 判断统计结果是否大于0  
    // 是：当前尝试删除的类别关联到了某些属性模板，抛出异常（CONFLICT）  
    // 调用SpuMapper对象的countByCategory()执行统计  
    // 判断统计结果是否大于0  
    // 是：当前尝试删除的类别关联到了某些SPU，抛出异常（CONFLICT）

    // 调用Mapper对象的deleteById()执行删除

    // 从此前的查询结果中找到当前删除的类别的父级类别ID  
    // 判断父级类别ID是否不为0  
    // 调用Mapper对象的countByParentId()执行统计  
    // 判断统计结果是否等于0  
    // 是：将父级类别的isParent更新为0  
}  
```  
  
具体实现为：  
  
```java  
@Override  
public void delete(Long id) {  
    // 调用Mapper对象的getStandardById()执行查询  
    CategoryStandardVO currentCategory = categoryMapper.getStandardById(id);  
    // 判断查询结果是否为null  
    if (currentCategory == null) {  
        // 是：数据已经不存在，抛出异常（NOT_FOUND）  
        String message = "删除类别失败，尝试删除的类别不存在！";  
        log.warn(message);  
        throw new ServiceException(ServiceCode.ERR_NOT_FOUND, message);  
    }  
  
    // 判断以上查询结果中的isParent是否为1  
    if (currentCategory.getIsParent() == 1) {  
        // 是：当前尝试删除的是父级类别，抛出异常（CONFLICT）  
        String message = "删除类别失败，尝试删除的类别仍包含子级类别！";  
        log.warn(message);  
        throw new ServiceException(ServiceCode.ERR_CONFLICT, message);  
    }  
  
    {  
        // 调用BrandCategoryMapper对象的countByCategory()执行统计  
        int count = brandCategoryMapper.countByCategoryId(id);  
        // 判断统计结果是否大于0  
        if (count > 0) {  
            // 是：当前尝试删除的类别关联到了某些品牌，抛出异常（CONFLICT）  
            String message = "删除类别失败，尝试删除的类别关联了某些品牌！";  
            log.warn(message);  
            throw new ServiceException(ServiceCode.ERR_CONFLICT, message);  
        }  
    }  
  
    {  
        // 调用CategoryAttributeTemplateMapper对象的countByCategory()执行统计  
        int count = categoryAttributeTemplateMapper.countByCategoryId(id);  
        // 判断统计结果是否大于0  
        if (count > 0) {  
            // 是：当前尝试删除的类别关联到了某些属性模板，抛出异常（CONFLICT）  
            String message = "删除类别失败，尝试删除的类别关联了某些属性模板！";  
            log.warn(message);  
            throw new ServiceException(ServiceCode.ERR_CONFLICT, message);  
        }  
    }  
  
    {  
        // 调用SpuMapper对象的countByCategory()执行统计  
        int count = spuMapper.countByCategoryId(id);  
        // 判断统计结果是否大于0  
        if (count > 0) {  
            // 是：当前尝试删除的类别关联到了某些SPU，抛出异常（CONFLICT）  
            String message = "删除类别失败，尝试删除的类别关联了某些SPU！";  
            log.warn(message);  
            throw new ServiceException(ServiceCode.ERR_CONFLICT, message);  
        }  
    }  
  
    // 调用Mapper对象的deleteById()执行删除  
    log.debug("即将执行删除类别，参数：{}", id);  
    categoryMapper.deleteById(id);  
  
    // 从此前的查询结果中找到当前删除的类别的父级类别ID  
    Long parentId = currentCategory.getParentId();  
    // 判断父级类别ID是否不为0  
    if (parentId != 0) {  
        // 调用Mapper对象的countByParentId()执行统计  
        int count = categoryMapper.countByParentId(parentId);  
        // 判断统计结果是否等于0  
        if (count == 0) {  
            // 是：将父级类别的isParent更新为0  
            Category parentCategory = new Category();  
            parentCategory.setId(parentId);  
            parentCategory.setIsParent(0);  
            categoryMapper.update(parentCategory);  
        }  
    }  
}
```  
  
在`CategoryServiceTests`中编写并执行测试：  
  
```java  
@Test
void delete() {
    Long id = 74L;
	
    try {
	    service.delete(id);
	    log.debug("删除类别成功！");
    } catch (ServiceException e) {
	    log.debug("捕获到异常，其中的消息：{}", e.getMessage());
    }
}
```

